2025-04-17 15:38:30,745 - {'optimizer': {'name': 'adam', 'lr': 0.001, 'weight_decay': 0}, 'train': {'epoch': 1000, 'batch_size': 1024, 'save_model': False, 'loss': 'pairwise', 'test_step': 3, 'reproducible': True, 'seed': 2024, 'patience': 20}, 'test': {'metrics': ['recall', 'ndcg'], 'k': [5, 10, 20], 'batch_size': 1024}, 'data': {'type': 'general_cf', 'name': 'yelp', 'user_num': 11091, 'item_num': 11010}, 'model': {'name': 'mult_vae_mddm', 'beta': 0.4, 'embedding_size': 32, 'dropout': 0.2, 'reg_weight': 1e-06, 'amazon': {'dropout': 0.3, 'reg_weight': 1e-06}, 'yelp': {'dropout': 0.3, 'reg_weight': 1e-06}, 'steam': {'dropout': 0.2, 'reg_weight': 1e-06}}}
2025-04-17 15:38:32,872 - Epoch   0 Validation set [recall@5: 0.0057 recall@10: 0.0106 recall@20: 0.0189 ] [ndcg@5: 0.0072 ndcg@10: 0.0090 ndcg@20: 0.0119 ] 
2025-04-17 15:38:34,844 - Epoch   3 Validation set [recall@5: 0.0238 recall@10: 0.0395 recall@20: 0.0607 ] [ndcg@5: 0.0299 ndcg@10: 0.0345 ndcg@20: 0.0414 ] 
2025-04-17 15:38:36,823 - Epoch   6 Validation set [recall@5: 0.0324 recall@10: 0.0526 recall@20: 0.0856 ] [ndcg@5: 0.0386 ndcg@10: 0.0445 ndcg@20: 0.0555 ] 
2025-04-17 15:38:38,753 - Epoch   9 Validation set [recall@5: 0.0328 recall@10: 0.0556 recall@20: 0.0895 ] [ndcg@5: 0.0398 ndcg@10: 0.0466 ndcg@20: 0.0580 ] 
2025-04-17 15:38:40,688 - Epoch  12 Validation set [recall@5: 0.0350 recall@10: 0.0582 recall@20: 0.0954 ] [ndcg@5: 0.0424 ndcg@10: 0.0493 ndcg@20: 0.0617 ] 
2025-04-17 15:38:42,620 - Epoch  15 Validation set [recall@5: 0.0378 recall@10: 0.0638 recall@20: 0.1023 ] [ndcg@5: 0.0446 ndcg@10: 0.0526 ndcg@20: 0.0657 ] 
2025-04-17 15:38:44,580 - Epoch  18 Validation set [recall@5: 0.0395 recall@10: 0.0643 recall@20: 0.1054 ] [ndcg@5: 0.0458 ndcg@10: 0.0532 ndcg@20: 0.0672 ] 
2025-04-17 15:38:46,568 - Epoch  21 Validation set [recall@5: 0.0386 recall@10: 0.0654 recall@20: 0.1075 ] [ndcg@5: 0.0459 ndcg@10: 0.0544 ndcg@20: 0.0683 ] 
2025-04-17 15:38:48,515 - Epoch  24 Validation set [recall@5: 0.0401 recall@10: 0.0676 recall@20: 0.1108 ] [ndcg@5: 0.0471 ndcg@10: 0.0557 ndcg@20: 0.0705 ] 
2025-04-17 15:38:50,465 - Epoch  27 Validation set [recall@5: 0.0397 recall@10: 0.0680 recall@20: 0.1109 ] [ndcg@5: 0.0476 ndcg@10: 0.0565 ndcg@20: 0.0711 ] 
2025-04-17 15:38:52,405 - Epoch  30 Validation set [recall@5: 0.0426 recall@10: 0.0707 recall@20: 0.1150 ] [ndcg@5: 0.0501 ndcg@10: 0.0587 ndcg@20: 0.0736 ] 
2025-04-17 15:38:54,373 - Epoch  33 Validation set [recall@5: 0.0421 recall@10: 0.0713 recall@20: 0.1184 ] [ndcg@5: 0.0497 ndcg@10: 0.0586 ndcg@20: 0.0745 ] 
2025-04-17 15:38:56,273 - Epoch  36 Validation set [recall@5: 0.0431 recall@10: 0.0734 recall@20: 0.1204 ] [ndcg@5: 0.0504 ndcg@10: 0.0603 ndcg@20: 0.0763 ] 
2025-04-17 15:38:58,211 - Epoch  39 Validation set [recall@5: 0.0432 recall@10: 0.0732 recall@20: 0.1195 ] [ndcg@5: 0.0509 ndcg@10: 0.0605 ndcg@20: 0.0764 ] 
2025-04-17 15:39:00,123 - Epoch  42 Validation set [recall@5: 0.0442 recall@10: 0.0748 recall@20: 0.1222 ] [ndcg@5: 0.0514 ndcg@10: 0.0612 ndcg@20: 0.0772 ] 
2025-04-17 15:39:02,053 - Epoch  45 Validation set [recall@5: 0.0452 recall@10: 0.0745 recall@20: 0.1238 ] [ndcg@5: 0.0516 ndcg@10: 0.0609 ndcg@20: 0.0778 ] 
2025-04-17 15:39:03,973 - Epoch  48 Validation set [recall@5: 0.0461 recall@10: 0.0760 recall@20: 0.1246 ] [ndcg@5: 0.0534 ndcg@10: 0.0627 ndcg@20: 0.0790 ] 
2025-04-17 15:39:05,943 - Epoch  51 Validation set [recall@5: 0.0443 recall@10: 0.0768 recall@20: 0.1243 ] [ndcg@5: 0.0523 ndcg@10: 0.0627 ndcg@20: 0.0788 ] 
2025-04-17 15:39:07,909 - Epoch  54 Validation set [recall@5: 0.0468 recall@10: 0.0771 recall@20: 0.1256 ] [ndcg@5: 0.0538 ndcg@10: 0.0632 ndcg@20: 0.0796 ] 
2025-04-17 15:39:09,839 - Epoch  57 Validation set [recall@5: 0.0461 recall@10: 0.0768 recall@20: 0.1257 ] [ndcg@5: 0.0532 ndcg@10: 0.0630 ndcg@20: 0.0796 ] 
2025-04-17 15:39:11,740 - Epoch  60 Validation set [recall@5: 0.0472 recall@10: 0.0777 recall@20: 0.1273 ] [ndcg@5: 0.0533 ndcg@10: 0.0631 ndcg@20: 0.0801 ] 
2025-04-17 15:39:13,641 - Epoch  63 Validation set [recall@5: 0.0452 recall@10: 0.0765 recall@20: 0.1268 ] [ndcg@5: 0.0530 ndcg@10: 0.0632 ndcg@20: 0.0803 ] 
2025-04-17 15:39:15,563 - Epoch  66 Validation set [recall@5: 0.0451 recall@10: 0.0750 recall@20: 0.1260 ] [ndcg@5: 0.0518 ndcg@10: 0.0614 ndcg@20: 0.0788 ] 
2025-04-17 15:39:17,502 - Epoch  69 Validation set [recall@5: 0.0462 recall@10: 0.0776 recall@20: 0.1268 ] [ndcg@5: 0.0528 ndcg@10: 0.0630 ndcg@20: 0.0799 ] 
2025-04-17 15:39:19,433 - Epoch  72 Validation set [recall@5: 0.0456 recall@10: 0.0796 recall@20: 0.1254 ] [ndcg@5: 0.0518 ndcg@10: 0.0633 ndcg@20: 0.0789 ] 
2025-04-17 15:39:21,349 - Epoch  75 Validation set [recall@5: 0.0449 recall@10: 0.0778 recall@20: 0.1269 ] [ndcg@5: 0.0512 ndcg@10: 0.0622 ndcg@20: 0.0790 ] 
2025-04-17 15:39:23,318 - Epoch  78 Validation set [recall@5: 0.0456 recall@10: 0.0769 recall@20: 0.1265 ] [ndcg@5: 0.0520 ndcg@10: 0.0621 ndcg@20: 0.0790 ] 
2025-04-17 15:39:25,212 - Epoch  81 Validation set [recall@5: 0.0455 recall@10: 0.0792 recall@20: 0.1270 ] [ndcg@5: 0.0521 ndcg@10: 0.0631 ndcg@20: 0.0794 ] 
2025-04-17 15:39:27,154 - Epoch  84 Validation set [recall@5: 0.0463 recall@10: 0.0775 recall@20: 0.1271 ] [ndcg@5: 0.0521 ndcg@10: 0.0622 ndcg@20: 0.0793 ] 
2025-04-17 15:39:29,109 - Epoch  87 Validation set [recall@5: 0.0453 recall@10: 0.0760 recall@20: 0.1266 ] [ndcg@5: 0.0524 ndcg@10: 0.0618 ndcg@20: 0.0790 ] 
2025-04-17 15:39:31,018 - Epoch  90 Validation set [recall@5: 0.0459 recall@10: 0.0773 recall@20: 0.1286 ] [ndcg@5: 0.0519 ndcg@10: 0.0621 ndcg@20: 0.0797 ] 
2025-04-17 15:39:32,922 - Epoch  93 Validation set [recall@5: 0.0463 recall@10: 0.0775 recall@20: 0.1277 ] [ndcg@5: 0.0533 ndcg@10: 0.0629 ndcg@20: 0.0800 ] 
2025-04-17 15:39:34,879 - Epoch  96 Validation set [recall@5: 0.0474 recall@10: 0.0775 recall@20: 0.1265 ] [ndcg@5: 0.0523 ndcg@10: 0.0621 ndcg@20: 0.0788 ] 
2025-04-17 15:39:36,813 - Epoch  99 Validation set [recall@5: 0.0462 recall@10: 0.0765 recall@20: 0.1260 ] [ndcg@5: 0.0527 ndcg@10: 0.0624 ndcg@20: 0.0793 ] 
2025-04-17 15:39:38,825 - Epoch 102 Validation set [recall@5: 0.0449 recall@10: 0.0757 recall@20: 0.1270 ] [ndcg@5: 0.0510 ndcg@10: 0.0610 ndcg@20: 0.0787 ] 
2025-04-17 15:39:40,745 - Epoch 105 Validation set [recall@5: 0.0458 recall@10: 0.0767 recall@20: 0.1253 ] [ndcg@5: 0.0518 ndcg@10: 0.0615 ndcg@20: 0.0782 ] 
2025-04-17 15:39:42,658 - Epoch 108 Validation set [recall@5: 0.0454 recall@10: 0.0762 recall@20: 0.1267 ] [ndcg@5: 0.0513 ndcg@10: 0.0615 ndcg@20: 0.0787 ] 
2025-04-17 15:39:44,553 - Epoch 111 Validation set [recall@5: 0.0471 recall@10: 0.0776 recall@20: 0.1265 ] [ndcg@5: 0.0525 ndcg@10: 0.0623 ndcg@20: 0.0790 ] 
2025-04-17 15:39:46,451 - Epoch 114 Validation set [recall@5: 0.0456 recall@10: 0.0768 recall@20: 0.1263 ] [ndcg@5: 0.0519 ndcg@10: 0.0619 ndcg@20: 0.0790 ] 
2025-04-17 15:39:48,380 - Epoch 117 Validation set [recall@5: 0.0460 recall@10: 0.0761 recall@20: 0.1255 ] [ndcg@5: 0.0503 ndcg@10: 0.0603 ndcg@20: 0.0774 ] 
2025-04-17 15:39:50,323 - Epoch 120 Validation set [recall@5: 0.0444 recall@10: 0.0751 recall@20: 0.1243 ] [ndcg@5: 0.0503 ndcg@10: 0.0605 ndcg@20: 0.0775 ] 
2025-04-17 15:39:52,220 - Epoch 123 Validation set [recall@5: 0.0462 recall@10: 0.0757 recall@20: 0.1240 ] [ndcg@5: 0.0513 ndcg@10: 0.0606 ndcg@20: 0.0772 ] 
2025-04-17 15:39:54,095 - Epoch 126 Validation set [recall@5: 0.0461 recall@10: 0.0757 recall@20: 0.1236 ] [ndcg@5: 0.0507 ndcg@10: 0.0604 ndcg@20: 0.0770 ] 
2025-04-17 15:39:55,990 - Epoch 129 Validation set [recall@5: 0.0452 recall@10: 0.0756 recall@20: 0.1224 ] [ndcg@5: 0.0508 ndcg@10: 0.0603 ndcg@20: 0.0765 ] 
2025-04-17 15:39:57,893 - Epoch 132 Validation set [recall@5: 0.0455 recall@10: 0.0752 recall@20: 0.1247 ] [ndcg@5: 0.0512 ndcg@10: 0.0604 ndcg@20: 0.0775 ] 
2025-04-17 15:39:59,834 - Epoch 135 Validation set [recall@5: 0.0442 recall@10: 0.0748 recall@20: 0.1235 ] [ndcg@5: 0.0495 ndcg@10: 0.0596 ndcg@20: 0.0765 ] 
2025-04-17 15:40:01,786 - Epoch 138 Validation set [recall@5: 0.0453 recall@10: 0.0734 recall@20: 0.1225 ] [ndcg@5: 0.0501 ndcg@10: 0.0590 ndcg@20: 0.0759 ] 
2025-04-17 15:40:03,687 - Epoch 141 Validation set [recall@5: 0.0448 recall@10: 0.0733 recall@20: 0.1223 ] [ndcg@5: 0.0493 ndcg@10: 0.0585 ndcg@20: 0.0754 ] 
2025-04-17 15:40:05,586 - Epoch 144 Validation set [recall@5: 0.0440 recall@10: 0.0738 recall@20: 0.1215 ] [ndcg@5: 0.0498 ndcg@10: 0.0592 ndcg@20: 0.0755 ] 
2025-04-17 15:40:07,503 - Epoch 147 Validation set [recall@5: 0.0449 recall@10: 0.0740 recall@20: 0.1226 ] [ndcg@5: 0.0497 ndcg@10: 0.0593 ndcg@20: 0.0761 ] 
2025-04-17 15:40:09,420 - Epoch 150 Validation set [recall@5: 0.0435 recall@10: 0.0728 recall@20: 0.1204 ] [ndcg@5: 0.0483 ndcg@10: 0.0582 ndcg@20: 0.0746 ] 
2025-04-17 15:40:10,641 - [recall@5: 0.0459 recall@10: 0.0773 recall@20: 0.1286 ] [ndcg@5: 0.0519 ndcg@10: 0.0621 ndcg@20: 0.0797 ] 
2025-04-17 15:40:11,899 - [recall@5: 0.0452 recall@10: 0.0775 recall@20: 0.1254 ] [ndcg@5: 0.0518 ndcg@10: 0.0622 ndcg@20: 0.0787 ] 
2025-04-17 15:40:11,899 - Best Epoch 90. Final test result: {'recall': array([0.04519724, 0.07754882, 0.12536064]), 'ndcg': array([0.05179543, 0.06217982, 0.07872187])}.
